System.register(["jimu-core","jimu-arcgis","esri/geometry/Point","esri/geometry/Polygon","esri/geometry/Polyline","esri/widgets/Sketch","esri/layers/GraphicsLayer","esri/Graphic","esri/widgets/LayerList","esri/core/reactiveUtils","esri/rest/support/Query","esri/geometry/geometryEngine","esri/geometry/SpatialReference.js","esri/geometry/projection.js","esri/layers/FeatureLayer.js"],(function(e,t){var o={},n={},r={},s={},a={},l={},i={},u={},d={},m={},c={},f={},_={},h={},p={};return{setters:[function(e){o.React=e.React},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){r.default=e.default},function(e){s.default=e.default},function(e){a.default=e.default},function(e){l.default=e.default},function(e){i.default=e.default},function(e){u.default=e.default},function(e){d.default=e.default},function(e){m.default=e.default},function(e){c.default=e.default},function(e){f.default=e.default},function(e){_.default=e.default},function(e){h.default=e.default},function(e){p.default=e.default}],execute:function(){e((()=>{var e={423:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var n=o(81),r=o.n(n),s=o(645),a=o.n(s)()(r());a.push([e.id,".spinner{width:32px;height:32px;border:8px solid;border-color:#3d5af1 transparent #3d5af1 transparent;border-radius:50%;animation:spin-anim 1.2s linear infinite;display:inline-block}@keyframes spin-anim{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}#pageoverlay{opacity:0.5;visibility:hidden;width:100%;height:100%;z-index:99999;top:0;left:0;position:fixed;cursor:wait;background-color:black;font-size:x-large}#pageoverlay-content{color:white;position:relative;width:50%;top:50%;left:50%;-moz-transform:translateX(-50%) translateY(-50%);-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center}\n",""]);const l=a},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var l=0;l<this.length;l++){var i=this[l][0];null!=i&&(a[i]=!0)}for(var u=0;u<e.length;u++){var d=[].concat(e[u]);n&&a[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),o&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=o):d[2]=o),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var s={},a=[],l=0;l<e.length;l++){var i=e[l],u=n.base?i[0]+n.base:i[0],d=s[u]||0,m="".concat(u," ").concat(d);s[u]=d+1;var c=o(m),f={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==c)t[c].references++,t[c].updater(f);else{var _=r(f,n);n.byIndex=l,t.splice(l,0,{identifier:m,updater:_,references:1})}a.push(m)}return a}function r(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,r){var s=n(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var l=o(s[a]);t[l].references--}for(var i=n(e,r),u=0;u<s.length;u++){var d=o(s[u]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=i}}},569:e=>{"use strict";var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n="";o.supports&&(n+="@supports (".concat(o.supports,") {")),o.media&&(n+="@media ".concat(o.media," {"));var r=void 0!==o.layer;r&&(n+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),n+=o.css,r&&(n+="}"),o.media&&(n+="}"),o.supports&&(n+="}");var s=o.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},129:e=>{"use strict";e.exports=u},135:e=>{"use strict";e.exports=m},294:e=>{"use strict";e.exports=r},19:e=>{"use strict";e.exports=s},920:e=>{"use strict";e.exports=a},693:e=>{"use strict";e.exports=_},942:e=>{"use strict";e.exports=f},422:e=>{"use strict";e.exports=h},49:e=>{"use strict";e.exports=p},231:e=>{"use strict";e.exports=i},902:e=>{"use strict";e.exports=c},447:e=>{"use strict";e.exports=d},560:e=>{"use strict";e.exports=l},826:e=>{"use strict";e.exports=n},891:e=>{"use strict";e.exports=o}},t={};function g(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,g),r.exports}g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var o in t)g.o(t,o)&&!g.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g.p="",g.nc=void 0;var v={};return g.p=window.jimuConfig.baseUrl,(()=>{"use strict";g.r(v),g.d(v,{__set_webpack_public_path__:()=>oe,default:()=>te,info:()=>ee,info1:()=>Q});var e=g(891),t=g(826),o=g(294),n=g(19),r=g(920),s=g(560),a=g(231),l=g(129),i=g(447),u=g(135),d=g(902),m=g(942),c=g(693),f=g(422),_=g(49);function h(e,t,o){let n=0,r=e.length-1;for(;n<=r;){let s=n+r>>1,a=o(e[s],t);if(a<0)n=s+1;else{if(!(a>0))return s;r=s-1}}return-(n+1)}function p(e,t){return t>e?-1:e>t?1:0}function y(e,t){if(t>e){if(t-e>1e-6)return-1}else if(e-t>1e-6)return 1;return 0}class b{m_dX;m_dY;static SAMEPOINTCMP(e,t){let o=y(e.m_dX,t.m_dX);return 0==o&&(o=y(e.m_dY,t.m_dY)),o}setCoords(e,t){this.m_dX=e,this.m_dY=t}}class w extends b{m_oRefs=[];m_nMasterIndex=-1;m_bIntersection=!1;m_oPrev=null;m_oEdgeToDest=null;m_bProcessed=!1;m_dDist=Number.MAX_VALUE;m_oFinalPrev=null;m_oFinalEdgeToDest=null;m_oFinalDist=Number.MAX_VALUE;static DIJKSTRACOMP(e,t){return e.m_dDist>t.m_dDist?-1:e.m_dDist<t.m_dDist?1:e.m_nMasterIndex-t.m_nMasterIndex}addRef(e){if(0===this.m_oRefs.length)this.m_oRefs.push(e);else{let t=!0;for(let o of this.m_oRefs.values())if(o===e){t=!1;break}t&&this.m_oRefs.push(e)}}removeRef(e){let t=this.m_oRefs.length;for(;t-- >0;)this.m_oRefs[t]==e&&this.m_oRefs.splice(t,1)}reset(){this.m_oPrev=null,this.m_oEdgeToDest=null,this.m_dDist=Number.MAX_VALUE,this.m_bProcessed=!1}}class M extends w{m_oGraphPoint=null;m_bAssociated=!1}class P{m_oGeo=[];m_dDist=Number.NaN;m_bKeep=!0;m_oCurrentHashes=[];m_oHashIndices={};m_dBB=[Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];m_nPos=-1;m_dPricePerFt;m_dCost;m_nAddressCount=0;static NULLEDGE=new P;getHashes(){this.m_oCurrentHashes=[],this.m_dBB[0]=Number.MAX_VALUE,this.m_dBB[1]=Number.MAX_VALUE,this.m_dBB[2]=-Number.MAX_VALUE,this.m_dBB[3]=-Number.MAX_VALUE;for(let e of this.m_oGeo.values()){e.m_dX<this.m_dBB[0]&&(this.m_dBB[0]=e.m_dX),e.m_dY<this.m_dBB[1]&&(this.m_dBB[1]=e.m_dY),e.m_dX>this.m_dBB[2]&&(this.m_dBB[2]=e.m_dX),e.m_dY>this.m_dBB[3]&&(this.m_dBB[3]=e.m_dY);let t=x(e.m_dX,e.m_dY),o=h(this.m_oCurrentHashes,t,p);o<0&&this.m_oCurrentHashes.splice(~o,0,t)}}calcDist(){let e=0;for(let t=0;t<this.m_oGeo.length-1;){let o=this.m_oGeo[t++],n=this.m_oGeo[t];e+=S(o.m_dX,o.m_dY,n.m_dX,n.m_dY)}this.m_dDist=e}}class G{m_oPoints=[];m_oNodes=[];m_oEdges=[]}class E{m_dU=Number.NaN;m_dV=Number.NaN;m_dDist=Number.MAX_VALUE;m_dXInt=Number.NaN;m_dYInt=Number.NaN;m_nIndex=-1;static NULLSNAP=new E;setValues(e,t,o,n,r){this.m_dU=e,this.m_dV=t,this.m_dDist=o,this.m_dXInt=n,this.m_dYInt=r}}const N=365221,R=Math.PI/180,I=2*Math.PI;function x(e,t){return 65536*Math.floor(100*e)+Math.floor(100*t)}function X(e,t,o,n,r,s){let a=x(e,t);s.hasOwnProperty(a)||(s[a]=new G);let l=s[a];n.setCoords(e,t),n.m_dX=e,n.m_dY=t;let i=h(l.m_oPoints,n,w.SAMEPOINTCMP);if(i<0){let o=new w;o.setCoords(e,t),i=~i,l.m_oPoints.splice(i,0,o),o.m_nMasterIndex=r.length,r.push(o)}let u=l.m_oPoints[i];u.addRef(o),o.m_oGeo.push(u)}function L(e,t,o){let n=[];switch(o){case 0:{let o=t.m_oGeo.length;for(;o-- >1;)n.push(t.m_oGeo[o]);for(let t of e.m_oGeo.values())n.push(e.m_oGeo[o]);break}case 1:for(let e=0;e<t.m_oGeo.length-1;e++)n.push(t.m_oGeo[e]);for(let t=0;t<e.m_oGeo.length;t++)n.push(e.m_oGeo[t]);break;case 2:for(let t=0;t<e.m_oGeo.length-1;t++)n.push(e.m_oGeo[t]);for(let e=0;e<t.m_oGeo.length;e++)n.push(t.m_oGeo[e]);break;case 3:{for(let t=0;t<e.m_oGeo.length;t++)n.push(e.m_oGeo[t]);let o=t.m_oGeo.length-1;for(;o-- >0;)n.push(t.m_oGeo[o]);break}default:return}for(let o of t.m_oGeo.values())o.addRef(e),o.removeRef(t);t.m_bKeep=!1,e.m_oGeo=n}function C(e){return e*R}function A(e,t,o,n,r,s,a){let l,i=[];for(let t=o.m_dX-.01;t<o.m_dX+.02;t+=.01)for(let n=o.m_dY-.01;n<o.m_dY+.02;n+=.01)if(l=x(t,n),e.hasOwnProperty(l))for(let t of e[l].m_oEdges.values())i.push(t);let u=E.NULLSNAP,d=null;for(let e of i.values()){if(0===e.m_oGeo.length)continue;let t=(m=n,c=e.m_dBB[1],m/function(e){return Math.cos(C(e))*N}(c));if(o.m_dX<e.m_dBB[0]-t||o.m_dX>e.m_dBB[2]+t||o.m_dY<e.m_dBB[1]-r||o.m_dY>e.m_dBB[3]+r)continue;let s=B(e.m_oGeo,o.m_dX,o.m_dY);Number.isNaN(s.m_dXInt)||s.m_dDist<n&&s.m_dDist<u.m_dDist&&(u=s,d=e)}var m,c;if(null==d||Number.isNaN(u.m_dXInt))return;let f=d.m_oGeo[u.m_nIndex],_=d.m_oGeo[u.m_nIndex+1],g=function(e,t,o,n){let r=C(e),s=C(t),a=C(o),l=C(n),i=Math.sin(a-r)*Math.cos(l),u=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-r),d=Math.atan2(i,u);return d<0&&(d+=I),I-d+Math.PI/2}(f.m_dX,f.m_dY,_.m_dX,_.m_dY);!function(e,t,o,n,r){let s=Math.PI/2-o;s<0&&(s+=I);let a=n/6371,l=t*R,i=e*R,u=Math.asin(Math.sin(l)*Math.cos(a)+Math.cos(l)*Math.sin(a)*Math.cos(s)),d=i+Math.atan2(Math.sin(s)*Math.sin(a)*Math.cos(l),Math.cos(a)-Math.sin(l)*Math.sin(u));r[0]=180*d/Math.PI,r[1]=180*u/Math.PI}(f.m_dX,f.m_dY,g,S(f.m_dX,f.m_dY,u.m_dXInt,u.m_dYInt)/1e3,s);let v=new P;v.m_dPricePerFt=d.m_dPricePerFt,X(s[0],s[1],v,a,t,e);let y=v.m_oGeo[0];if(o.m_oGraphPoint=y,0==b.SAMEPOINTCMP(y,d.m_oGeo[0])||0==b.SAMEPOINTCMP(y,d.m_oGeo[d.m_oGeo.length-1]))return void y.removeRef(v);let w=u.m_nIndex+1;for(;w<d.m_oGeo.length;){let e=d.m_oGeo[w++];e.removeRef(d),e.addRef(v),v.m_oGeo.push(e)}for(w=d.m_oGeo.length;--w>u.m_nIndex;)d.m_oGeo[w].removeRef(d),d.m_oGeo.splice(w,1);v.m_oGeo[0].addRef(d),d.m_oGeo.push(v.m_oGeo[0]),d.getHashes();for(let[t,o]of Object.entries(d.m_oHashIndices))h(d.m_oCurrentHashes,t,p)<0&&(e[t].m_oEdges[o]=P.NULLEDGE);v.getHashes();for(let t of v.m_oCurrentHashes){e.hasOwnProperty(t)||(e[t]=new G);let o=e[t];v.m_oHashIndices[t]=o.m_oEdges.length,o.m_oEdges.push(v)}}function B(e,t,o){let n=E.NULLSNAP,r=!1;for(let s=0;s<e.length-1;s++){let a=e[s],l=e[s+1],i=Y(t,o,a.m_dX,a.m_dY,l.m_dX,l.m_dY);if(Number.isNaN(i.m_dXInt))continue;if(i.m_nIndex=s,i.m_dU>=0&&i.m_dU<i.m_dV&&(r?i.m_dDist<n.m_dDist&&(n=i):(n=i,r=!0)),r)continue;let u=S(a.m_dX,a.m_dY,t,o),d=S(l.m_dX,l.m_dY,t,o);i.m_dDist=u<d?u:d,i.m_dDist<n.m_dDist&&(n=i)}if(r)return n;if(!Number.isNaN(n.m_dXInt)){let r;if(r=n.m_dU>0?n.m_dU-n.m_dV:-n.m_dU,!(r<3*n.m_dV))return E.NULLSNAP;{let r=e[n.m_nIndex],s=e[n.m_nIndex+1];S(r.m_dX,r.m_dY,t,o)<S(s.m_dX,s.m_dY,t,o)?(n.m_dXInt=r.m_dX,n.m_dYInt=r.m_dY):(n.m_dXInt=s.m_dX,n.m_dYInt=s.m_dY)}}return n}function Y(e,t,o,n,r,s){let a=r-o,l=s-n,i=e-o,u=t-n;if(0==a&&0==l)return E.NULLSNAP;let d=i*a+u*l,m=a*a+l*l,c=o+d*a/m,f=n+d*l/m,_=new E;return _.setValues(d,m,S(e,t,c,f),c,f),_}function S(e,t,o,n){let r=(o-e)*R,s=(n-t)*R,a=Math.sin(s/2),l=Math.sin(r/2),i=a*a+Math.cos(t*R)*Math.cos(n*R)*l*l;return 12742e3*Math.asin(Math.sqrt(i))}var D=g(379),T=g.n(D),F=g(795),U=g.n(F),O=g(569),V=g.n(O),j=g(565),k=g.n(j),H=g(216),K=g.n(H),W=g(589),$=g.n(W),q=g(423),J={};J.styleTagTransform=$(),J.setAttributes=k(),J.insert=V().bind(null,"head"),J.domAPI=U(),J.insertStyleElement=K(),T()(q.Z,J),q.Z&&q.Z.locals&&q.Z.locals;var z=function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{i(n.next(e))}catch(e){s(e)}}function l(e){try{i(n.throw(e))}catch(e){s(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}i((n=n.apply(e,t||[])).next())}))};const{useState:Z}=e.React;function Q(e){document.getElementById("info").innerHTML=e}function ee(e){setTimeout((()=>document.getElementById("pageoverlay-content").innerText=e),10)}const te=p=>{var g;const[v,E]=Z(),[R,I]=Z(),[x,C]=Z(),[B,Y]=Z(),[S,D]=Z(),[T,F]=Z(""),[U,O]=Z(""),[V,j]=Z(""),[k,H]=Z("-97.0179938"),[K,W]=Z("30.4639858");let $=[],q=["Cost_FT"];return e.React.createElement("div",{className:"widget-starter jimu-widget"},p.useMapWidgetIds&&1===p.useMapWidgetIds.length&&e.React.createElement(t.JimuMapViewComponent,{useMapWidgetId:null===(g=p.useMapWidgetIds)||void 0===g?void 0:g[0],onActiveViewChange:e=>{if(e){let t=document.createElement("div");t.id="pageoverlay",t.innerHTML="<p id=pageoverlay-content></p>",document.body.appendChild(t),E(e);let o=new a.default({title:"Sketch Widget",id:"mySketch"});e.view.map.add(o),C(o);let n=new s.default({layer:o,view:e.view,creationMode:"single",container:"sketch-container",snappingOptions:{enabled:!0,featureEnabled:!0}});n.visibleElements={createTools:{circle:!1,polyline:!1,rectangle:!1},duplicateButton:!1,selectionTools:{"rectangle-selection":!1,"lasso-selection":!1},settingsMenu:!1},n.on("create",(function(e){return z(this,void 0,void 0,(function*(){"complete"===e.state&&("polygon"===e.tool?Y(e.graphic.geometry):"point"===e.tool&&D(e.graphic.geometry))}))})),I(n);let r=new i.default({view:e.view,visible:!0});e.view.ui.add(r,"top-right")}}}),e.React.createElement("div",{id:"loading-widget-ui"},"Loading widget... ",e.React.createElement("div",{className:"spinner"})),e.React.createElement("div",{id:"main-widget-ui",style:{visibility:"hidden"}},e.React.createElement("label",null,"Select Address Layer",e.React.createElement("select",{id:"select-address",value:T,onChange:e=>F(e.target.value)})),e.React.createElement("label",null,"Select Road Layer",e.React.createElement("select",{id:"select-road",value:U,onChange:e=>O(e.target.value)})),e.React.createElement("label",null,"Select Output Layer",e.React.createElement("select",{id:"select-output",value:V,onChange:e=>j(e.target.value)})),e.React.createElement("div",{id:"sketch-container"}),e.React.createElement("div",{id:"info"}),e.React.createElement("button",{onClick:function(){return z(this,void 0,void 0,(function*(){document.getElementById("pageoverlay").style.visibility="visible";try{ee("start");let e=f.default.load();ee("loaded");let t=new d.default;t.spatialRelationship="intersects",t.outFields=$,t.geometry=B,t.returnGeometry=!0;const s=yield v.view.whenLayerView(v.view.map.findLayerById(T));let a=new _.default({url:s.layer.url});a.outFields=$,yield u.default.whenOnce((()=>!s.updating));const i=a.queryFeatures(t),p=yield i;let g=S.x,E=S.y,I=S.x,x=S.y;for(let e of B.rings[0].values())e[0]<g&&(g=e[0]),e[1]<E&&(E=e[1]),e[0]>I&&(I=e[0]),e[1]>x&&(x=e[1]);let C=m.default.buffer(new n.default({rings:[[[g,E],[g,x],[I,x],[I,E],[g,E]]],spatialReference:B.spatialReference}),2,"kilometers"),Y=new d.default;Y.outFields=q,Y.spatialRelationship="intersects",Y.geometry=C,Y.returnGeometry=!0;const D=yield v.view.whenLayerView(v.view.map.findLayerById(U));let F=new _.default({url:D.layer.url});F.outFields=q,yield u.default.whenOnce((()=>!D.updating));const O=F.queryFeatures(Y),j=yield O;let k=[];for(let e of j.features.values())m.default.disjoint(C,e.geometry)||k.push(e);ee(`Points: ${p.features.length}<br/>Lines: ${k.length}`),yield e;let H=function(e,t,o,n,r,s){P.NULLEDGE.m_bKeep=!1;let a={},l=[],i=[],u=new w,d=[];ee("projecting points");for(let t of e.features.values()){let e=n.project(t.geometry,s),o=new M;o.setCoords(e.longitude,e.latitude),d.push(o)}{let e=n.project(o,s),t=new M;t.setCoords(e.longitude,e.latitude),d.push(t)}ee("projecting roads");for(let e of t.values()){let t=n.project(e.geometry,s);for(let o of t.paths.values()){let t=new P;t.m_dPricePerFt=e.attributes.Cost_FT;for(let e of o.values())X(e[0],e[1],t,u,l,a);i.push(t)}}ee("split"),i=function(e){let t=[],o=e.length;for(let n=0;n<o;n++){let o=e[n],r=!1,s=new P;s.m_oGeo.push(o.m_oGeo[0]);let a=o.m_oGeo.length-1;for(let e=1;e<a;e++){let n=o.m_oGeo[e];if(s.m_oGeo.push(n),1!==n.m_oRefs.length){s.m_dPricePerFt=o.m_dPricePerFt,t.push(s);for(let e=0;e<s.m_oGeo.length;e++){let t=s.m_oGeo[e];t.addRef(s),t.removeRef(o)}r=!0,s=new P,s.m_oGeo.push(n)}}if(r){s.m_oGeo.push(o.m_oGeo[o.m_oGeo.length-1]),s.m_dPricePerFt=o.m_dPricePerFt,t.push(s);for(let e=0;e<s.m_oGeo.length;e++){let t=s.m_oGeo[e];t.addRef(s),t.removeRef(o)}}else t.push(o)}return t}(i),ee("merge"),i=function(e){let t=[],o=e.length;for(let t=0;t<o;t++){let o=e[t];if(!o.m_bKeep)continue;let n=o.m_oGeo[0],r=o.m_oGeo[o.m_oGeo.length-1],s=-1,a=-1;if(2==n.m_oRefs.length){let e=n.m_oRefs[0];o===e&&(e=n.m_oRefs[1]);let t=e.m_oGeo[0],r=e.m_oGeo[e.m_oGeo.length-1];0==b.SAMEPOINTCMP(n,t)?s=0:0==b.SAMEPOINTCMP(n,r)&&(s=1),s>=0&&L(o,e,s)}if(2===r.m_oRefs.length){let e=r.m_oRefs[0];o===e&&(e=r.m_oRefs[1]);let t=e.m_oGeo[0],n=e.m_oGeo[e.m_oGeo.length-1];0==b.SAMEPOINTCMP(r,t)?a=2:0==b.SAMEPOINTCMP(r,n)&&(a=3),a>=0&&L(o,e,a)}}for(let o of e.values())o.m_bKeep&&t.push(o);return t}(i),ee("setting intersections");let m=[null,null];for(let e of i.values()){e.m_bKeep=!0,e.getHashes(),m[0]=e.m_oGeo[0],m[1]=e.m_oGeo[e.m_oGeo.length-1];for(let e of m.values())e.m_bIntersection=!0;for(let t of e.m_oCurrentHashes.values()){a.hasOwnProperty(t)||(a[t]=new G);let o=a[t];e.m_oHashIndices[t]=o.m_oEdges.length,o.m_oEdges.push(e)}}ee("service points"),i=function(e,t,o,n,r){let s=1936.0000000000002/N,a=[Number.NaN,Number.NaN];for(let n of e.values())A(t,o,n,1760,s,a,r);let l=[];for(let e of Object.values(t))for(let t of e.m_oEdges.values())t.m_bKeep&&(t.m_nPos=l.length,l.push(t),t.m_bKeep=!1);return l}(d,a,l,0,u),ee("distances");for(let e of i.values())e.calcDist(),e.m_dDist*=3.280839895,e.m_dCost=e.m_dDist*e.m_dPricePerFt;let c=d[d.length-1];return d.splice(d.length-1,1),{edges:i,hashes:a,nodes:l,routeTo:c,servicePoints:d}}(p,k,S,f.default,m.default,c.default.WGS84);if(null===H)return;ee(`New lines: ${H.edges.length}`),function(e){let t=[];for(e.m_oPrev=e,e.m_dDist=0,t.push(e);t.length>0;){let e=t[t.length-1];t.splice(t.length-1,1),0==y(e.m_dX,-97.60798119960994)&&0==y(e.m_dY,30.60918129980949)&&console.log("cur");for(let o of e.m_oRefs.values()){let n=o.m_oGeo[0];n===e&&(n=o.m_oGeo[o.m_oGeo.length-1]),0==y(n.m_dX,-97.60798119960994)&&0==y(n.m_dY,30.60918129980949)&&console.log("here");let r=e.m_dDist+o.m_dCost;if(r<n.m_dDist&&(n.m_dDist=r,n.m_oPrev=e,n.m_oEdgeToDest=o),!n.m_bProcessed){let e=h(t,n,w.DIJKSTRACOMP);e<0&&t.splice(~e,0,n)}}e.m_bProcessed=!0}}(H.routeTo.m_oGraphPoint);let K=0,W=0,J=0;for(let e of H.nodes.values())e.m_bIntersection&&null===e.m_oPrev&&(++W,R.layer.add(new l.default({geometry:new o.default({x:e.m_dX,y:e.m_dY,spatialReference:c.default.WGS84}),attributes:{aaron:!0}}))),e.m_bProcessed&&++J;for(let e of H.servicePoints.values()){let t=e.m_oGraphPoint;for(null===t&&++K;null!==t&&null!==t.m_oPrev&&t!==H.routeTo.m_oGraphPoint;)++t.m_oEdgeToDest.m_nAddressCount,t=t.m_oPrev}ee(`No snap: ${K}<br/>No route: ${W}<br/>Total: ${H.nodes.length}<br/>Processed: ${J}`);let z=[];for(let e of H.edges.values()){if(0==e.m_nAddressCount)continue;let t=[],o=[];for(let t of e.m_oGeo.values())o.push([t.m_dX,t.m_dY]);t.push(o);let n=new r.default({paths:t,spatialReference:c.default.WGS84});z.push(new l.default({geometry:n,attributes:{cost:e.m_dCost}}))}const Z=yield v.view.whenLayerView(v.view.map.findLayerById(V));let Q=new _.default({url:Z.layer.url});yield u.default.whenOnce((()=>!Z.updating)),Q.applyEdits({addFeatures:z}).then((e=>{e.addFeatureResults.length>0&&console.log(e.addFeatureResults[0].objectId)})).catch((e=>{console.error()})),ee("done")}catch(e){ee(e)}finally{setTimeout((()=>document.getElementById("pageoverlay").style.visibility="hidden"),1500)}}))}},"Execute"),e.React.createElement("br",null),e.React.createElement("button",{onClick:function(){return z(this,void 0,void 0,(function*(){const e=yield v.view.whenLayerView(v.view.map.findLayerById(V));let t=new _.default({url:e.layer.url});yield u.default.whenOnce((()=>!e.updating));let o={deleteFeatures:(yield t.queryFeatures()).features};t.applyEdits(o);let n=[],s=[],a=[],i=Number.parseFloat(k),d=Number.parseFloat(K);for(let e=0;e<5;e++)a.push([i+.5*e,d+.5*e]);s.push(a);let m=new r.default({paths:s,spatialReference:c.default.WGS84}),f=new l.default({geometry:m,attributes:{myfield:"huzzah"}});n.push(f);let h={addFeatures:n};t.applyEdits(h).then((e=>{e.addFeatureResults.length>0&&console.log(e.addFeatureResults[0].objectId)})).catch((e=>{console.error()}))}))}},"Add"),e.React.createElement("br",null),e.React.createElement("button",{onClick:function(){return z(this,void 0,void 0,(function*(){const e=yield v.view.whenLayerView(v.view.map.findLayerById(V));let t=new _.default({url:e.layer.url});yield u.default.whenOnce((()=>!e.updating));let o={deleteFeatures:(yield t.queryFeatures()).features};t.applyEdits(o);let n=[];for(let e of R.layer.graphics)null!==e.attributes&&e.attributes.aaron&&n.push(e);R.layer.removeMany(n)}))}},"Delete"),e.React.createElement("br",null),e.React.createElement("label",null,"Lon:",e.React.createElement("input",{value:k,onChange:e=>H(e.target.value)})),e.React.createElement("br",null),e.React.createElement("label",null,"Lat:",e.React.createElement("input",{value:K,onChange:e=>W(e.target.value)}))))};function oe(e){g.p=e}})(),v})())}}}));