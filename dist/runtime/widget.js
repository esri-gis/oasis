System.register(["jimu-core","jimu-arcgis","esri/geometry/Point","esri/geometry/Polygon","esri/geometry/Polyline","esri/widgets/Sketch","esri/layers/GraphicsLayer","esri/Graphic","esri/core/reactiveUtils","esri/rest/support/Query","esri/rest/featureService/FeatureService","esri/geometry/geometryEngine","esri/geometry/SpatialReference.js","esri/geometry/projection.js","esri/layers/FeatureLayer.js","esri/views/interactive/snapping/FeatureSnappingLayerSource.js"],(function(e,t){var o={},n={},r={},s={},i={},l={},a={},m={},u={},d={},c={},_={},f={},p={},h={},g={};return{setters:[function(e){o.React=e.React},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){r.default=e.default},function(e){s.default=e.default},function(e){i.default=e.default},function(e){l.default=e.default},function(e){a.default=e.default},function(e){m.default=e.default},function(e){u.default=e.default},function(e){d.default=e.default},function(e){c.default=e.default},function(e){_.default=e.default},function(e){f.default=e.default},function(e){p.default=e.default},function(e){h.default=e.default},function(e){g.default=e.default}],execute:function(){e((()=>{var e={423:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var n=o(81),r=o.n(n),s=o(645),i=o.n(s)()(r());i.push([e.id,".spinner{width:32px;height:32px;border:8px solid;border-color:#3d5af1 transparent #3d5af1 transparent;border-radius:50%;animation:spin-anim 1.2s linear infinite;display:inline-block}@keyframes spin-anim{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}#pageoverlay{opacity:0.5;visibility:hidden;width:100%;height:100%;z-index:99999;top:0;left:0;position:fixed;cursor:wait;background-color:black;font-size:x-large}#pageoverlay-content{color:white;position:relative;width:50%;top:50%;left:50%;-moz-transform:translateX(-50%) translateY(-50%);-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center}#main-widget-ui,#loading-widget-ui{padding:5px}\n",""]);const l=i},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(n)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(i[a]=!0)}for(var m=0;m<e.length;m++){var u=[].concat(e[m]);n&&i[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),o&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=o):u[2]=o),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var s={},i=[],l=0;l<e.length;l++){var a=e[l],m=n.base?a[0]+n.base:a[0],u=s[m]||0,d="".concat(m," ").concat(u);s[m]=u+1;var c=o(d),_={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==c)t[c].references++,t[c].updater(_);else{var f=r(_,n);n.byIndex=l,t.splice(l,0,{identifier:d,updater:f,references:1})}i.push(d)}return i}function r(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,r){var s=n(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<s.length;i++){var l=o(s[i]);t[l].references--}for(var a=n(e,r),m=0;m<s.length;m++){var u=o(s[m]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}s=a}}},569:e=>{"use strict";var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n="";o.supports&&(n+="@supports (".concat(o.supports,") {")),o.media&&(n+="@media ".concat(o.media," {"));var r=void 0!==o.layer;r&&(n+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),n+=o.css,r&&(n+="}"),o.media&&(n+="}"),o.supports&&(n+="}");var s=o.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},129:e=>{"use strict";e.exports=m},135:e=>{"use strict";e.exports=u},294:e=>{"use strict";e.exports=r},19:e=>{"use strict";e.exports=s},920:e=>{"use strict";e.exports=i},693:e=>{"use strict";e.exports=f},942:e=>{"use strict";e.exports=_},422:e=>{"use strict";e.exports=p},49:e=>{"use strict";e.exports=h},231:e=>{"use strict";e.exports=a},527:e=>{"use strict";e.exports=c},902:e=>{"use strict";e.exports=d},43:e=>{"use strict";e.exports=g},560:e=>{"use strict";e.exports=l},826:e=>{"use strict";e.exports=n},891:e=>{"use strict";e.exports=o}},t={};function y(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,y),r.exports}y.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return y.d(t,{a:t}),t},y.d=(e,t)=>{for(var o in t)y.o(t,o)&&!y.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},y.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),y.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},y.p="",y.nc=void 0;var v={};return y.p=window.jimuConfig.baseUrl,(()=>{"use strict";y.r(v),y.d(v,{__set_webpack_public_path__:()=>se,default:()=>re,drawPoint:()=>ne,drawPoly:()=>oe});var e=y(891),t=y(826),o=y(294),n=y(19),r=y(920),s=y(560),i=y(231),l=y(129),a=y(135),m=y(902),u=y(527),d=y(942),c=y(693),_=y(422),f=y(49),p=y(43);function h(e,t,o){let n=0,r=e.length-1;for(;n<=r;){let s=n+r>>1,i=o(e[s],t);if(i<0)n=s+1;else{if(!(i>0))return s;r=s-1}}return-(n+1)}function g(e,t){return t>e?-1:e>t?1:0}function P(e,t){if(t>e){if(t-e>1e-6)return-1}else if(e-t>1e-6)return 1;return 0}class w{m_dX;m_dY;static SAMEPOINTCMP(e,t){let o=P(e.m_dX,t.m_dX);return 0==o&&(o=P(e.m_dY,t.m_dY)),o}setCoords(e,t){this.m_dX=e,this.m_dY=t}}class b extends w{m_oRefs=[];m_nMasterIndex=-1;m_bIntersection=!1;m_oPrev=null;m_oEdgeToDest=null;m_bProcessed=!1;m_dDist=Number.MAX_VALUE;m_oVToCO=null;m_oEdgeToCO=null;m_dDistToCO=Number.MAX_VALUE;m_oTempV=null;m_oTempEdge=null;m_dTempDist=Number.MAX_VALUE;m_dRouteDistance=Number.MAX_VALUE;m_oVForRoute=null;m_oEdgeForRoute=null;static DIJKSTRACOMP(e,t){return e.m_dDist>t.m_dDist?-1:e.m_dDist<t.m_dDist?1:e.m_nMasterIndex-t.m_nMasterIndex}static DISTCOMP(e,t){return e.m_dDist<t.m_dDist?-1:e.m_dDist>t.m_dDist?1:0}addRef(e){if(0===this.m_oRefs.length)this.m_oRefs.push(e);else{let t=!0;for(let o of this.m_oRefs.values())if(o===e){t=!1;break}t&&this.m_oRefs.push(e)}}removeRef(e){let t=this.m_oRefs.length;for(;t-- >0;)this.m_oRefs[t]==e&&this.m_oRefs.splice(t,1)}reset(){this.m_oPrev=null,this.m_oEdgeToDest=null,this.m_dDist=Number.MAX_VALUE,this.m_bProcessed=!1}}class E extends b{m_oGraphPoint=null;m_bAssociated=!1;static GRAPHDISTCOMP(e,t){return e.m_oGraphPoint.m_dDist<t.m_oGraphPoint.m_dDist?-1:e.m_oGraphPoint.m_dDist>t.m_oGraphPoint.m_dDist?1:0}static REVERSEGRAPHDISTTOCOCOMP(e,t){return e.m_oGraphPoint.m_dDistToCO<t.m_oGraphPoint.m_dDistToCO?1:e.m_oGraphPoint.m_dDistToCO>t.m_oGraphPoint.m_dDistToCO?-1:0}static REVERSEGRAPHDISTCOMP(e,t){return-E.GRAPHDISTCOMP(e,t)}}class G{m_oGeo=[];m_dDist=Number.NaN;m_bKeep=!0;m_oCurrentHashes=[];m_oHashIndices={};m_dBB=[Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];m_nPos=-1;m_dPricePerFt;m_dCost;m_nAddressCount=0;m_sConstNew="";m_sUgType="";static NULLEDGE=new G;getHashes(){this.m_oCurrentHashes=[],this.m_dBB[0]=Number.MAX_VALUE,this.m_dBB[1]=Number.MAX_VALUE,this.m_dBB[2]=-Number.MAX_VALUE,this.m_dBB[3]=-Number.MAX_VALUE;for(let e of this.m_oGeo.values()){e.m_dX<this.m_dBB[0]&&(this.m_dBB[0]=e.m_dX),e.m_dY<this.m_dBB[1]&&(this.m_dBB[1]=e.m_dY),e.m_dX>this.m_dBB[2]&&(this.m_dBB[2]=e.m_dX),e.m_dY>this.m_dBB[3]&&(this.m_dBB[3]=e.m_dY);let t=D(e.m_dX,e.m_dY),o=h(this.m_oCurrentHashes,t,g);o<0&&this.m_oCurrentHashes.splice(~o,0,t)}}calcDist(){let e=0;for(let t=0;t<this.m_oGeo.length-1;){let o=this.m_oGeo[t++],n=this.m_oGeo[t];e+=L(o.m_dX,o.m_dY,n.m_dX,n.m_dY)}this.m_dDist=e}}class M{m_oPoints=[];m_oNodes=[];m_oEdges=[]}class R{m_dU=Number.NaN;m_dV=Number.NaN;m_dDist=Number.MAX_VALUE;m_dXInt=Number.NaN;m_dYInt=Number.NaN;m_nIndex=-1;static NULLSNAP=new R;setValues(e,t,o,n,r){this.m_dU=e,this.m_dV=t,this.m_dDist=o,this.m_dXInt=n,this.m_dYInt=r}}const T=365221,C=Math.PI/180,N=2*Math.PI;function D(e,t){return 65536*Math.floor(100*e)+Math.floor(100*t)}function I(e,t,o,n,r,s){let i=D(e,t);s.hasOwnProperty(i)||(s[i]=new M);let l=s[i];n.setCoords(e,t),n.m_dX=e,n.m_dY=t;let a=h(l.m_oPoints,n,b.SAMEPOINTCMP);if(a<0){let o=new b;o.setCoords(e,t),a=~a,l.m_oPoints.splice(a,0,o),o.m_nMasterIndex=r.length,r.push(o)}let m=l.m_oPoints[a];m.addRef(o),o.m_oGeo.push(m)}function A(e,t,o){let n=[];switch(o){case 0:{let o=t.m_oGeo.length;for(;o-- >1;)n.push(t.m_oGeo[o]);for(let t of e.m_oGeo.values())n.push(t);break}case 1:for(let e=0;e<t.m_oGeo.length-1;e++)n.push(t.m_oGeo[e]);for(let t=0;t<e.m_oGeo.length;t++)n.push(e.m_oGeo[t]);break;case 2:for(let t=0;t<e.m_oGeo.length-1;t++)n.push(e.m_oGeo[t]);for(let e=0;e<t.m_oGeo.length;e++)n.push(t.m_oGeo[e]);break;case 3:{for(let t=0;t<e.m_oGeo.length;t++)n.push(e.m_oGeo[t]);let o=t.m_oGeo.length-1;for(;o-- >0;)n.push(t.m_oGeo[o]);break}default:return}for(let o of t.m_oGeo.values())o.addRef(e),o.removeRef(t);t.m_bKeep=!1,e.m_oGeo=n}function O(e){return e*C}function x(e,t,o,n,r,s,i){let l,a=[];for(let t=o.m_dX-.01;t<o.m_dX+.02;t+=.01)for(let n=o.m_dY-.01;n<o.m_dY+.02;n+=.01)if(l=D(t,n),e.hasOwnProperty(l))for(let t of e[l].m_oEdges.values())a.push(t);let m=R.NULLSNAP,u=null;for(let e of a.values()){if(0===e.m_oGeo.length)continue;let t=(d=n,c=e.m_dBB[1],d/function(e){return Math.cos(O(e))*T}(c));if(o.m_dX<e.m_dBB[0]-t||o.m_dX>e.m_dBB[2]+t||o.m_dY<e.m_dBB[1]-r||o.m_dY>e.m_dBB[3]+r)continue;let s=S(e.m_oGeo,o.m_dX,o.m_dY);Number.isNaN(s.m_dXInt)||s.m_dDist<n&&s.m_dDist<m.m_dDist&&(m=s,u=e)}var d,c;if(null==u||Number.isNaN(m.m_dXInt))return;let _=u.m_oGeo[m.m_nIndex],f=u.m_oGeo[m.m_nIndex+1],p=function(e,t,o,n){let r=O(e),s=O(t),i=O(o),l=O(n),a=Math.sin(i-r)*Math.cos(l),m=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(i-r),u=Math.atan2(a,m);return u<0&&(u+=N),N-u+Math.PI/2}(_.m_dX,_.m_dY,f.m_dX,f.m_dY);!function(e,t,o,n,r){let s=Math.PI/2-o;s<0&&(s+=N);let i=n/6371,l=t*C,a=e*C,m=Math.asin(Math.sin(l)*Math.cos(i)+Math.cos(l)*Math.sin(i)*Math.cos(s)),u=a+Math.atan2(Math.sin(s)*Math.sin(i)*Math.cos(l),Math.cos(i)-Math.sin(l)*Math.sin(m));r[0]=180*u/Math.PI,r[1]=180*m/Math.PI}(_.m_dX,_.m_dY,p,L(_.m_dX,_.m_dY,m.m_dXInt,m.m_dYInt)/1e3,s);let y=new G;y.m_dPricePerFt=u.m_dPricePerFt,y.m_sConstNew=u.m_sConstNew,y.m_sUgType=u.m_sUgType,I(s[0],s[1],y,i,t,e);let v=y.m_oGeo[0];if(o.m_oGraphPoint=v,0==w.SAMEPOINTCMP(v,u.m_oGeo[0])||0==w.SAMEPOINTCMP(v,u.m_oGeo[u.m_oGeo.length-1]))return void v.removeRef(y);let P=m.m_nIndex+1;for(;P<u.m_oGeo.length;){let e=u.m_oGeo[P++];e.removeRef(u),e.addRef(y),y.m_oGeo.push(e)}for(P=u.m_oGeo.length;--P>m.m_nIndex;)u.m_oGeo[P].removeRef(u),u.m_oGeo.splice(P,1);y.m_oGeo[0].addRef(u),u.m_oGeo.push(y.m_oGeo[0]),u.getHashes();for(let[t,o]of Object.entries(u.m_oHashIndices))h(u.m_oCurrentHashes,t,g)<0&&(e[t].m_oEdges[o]=G.NULLEDGE);y.getHashes();for(let t of y.m_oCurrentHashes){e.hasOwnProperty(t)||(e[t]=new M);let o=e[t];y.m_oHashIndices[t]=o.m_oEdges.length,o.m_oEdges.push(y)}}function S(e,t,o){let n=R.NULLSNAP,r=!1;for(let s=0;s<e.length-1;s++){let i=e[s],l=e[s+1],a=X(t,o,i.m_dX,i.m_dY,l.m_dX,l.m_dY);if(Number.isNaN(a.m_dXInt))continue;if(a.m_nIndex=s,a.m_dU>=0&&a.m_dU<a.m_dV&&(r?a.m_dDist<n.m_dDist&&(n=a):(n=a,r=!0)),r)continue;let m=L(i.m_dX,i.m_dY,t,o),u=L(l.m_dX,l.m_dY,t,o);a.m_dDist=m<u?m:u,a.m_dDist<n.m_dDist&&(n=a)}if(r)return n;if(!Number.isNaN(n.m_dXInt)){let r;if(r=n.m_dU>0?n.m_dU-n.m_dV:-n.m_dU,!(r<10*n.m_dV))return R.NULLSNAP;{let r=e[n.m_nIndex],s=e[n.m_nIndex+1];L(r.m_dX,r.m_dY,t,o)<L(s.m_dX,s.m_dY,t,o)?(n.m_dXInt=r.m_dX,n.m_dYInt=r.m_dY):(n.m_dXInt=s.m_dX,n.m_dYInt=s.m_dY)}}return n}function X(e,t,o,n,r,s){let i=r-o,l=s-n,a=e-o,m=t-n;if(0==i&&0==l)return R.NULLSNAP;let u=a*i+m*l,d=i*i+l*l,c=o+u*i/d,_=n+u*l/d,f=new R;return f.setValues(u,d,L(e,t,c,_),c,_),f}function L(e,t,o,n){let r=(o-e)*C,s=(n-t)*C,i=Math.sin(s/2),l=Math.sin(r/2),a=i*i+Math.cos(t*C)*Math.cos(n*C)*l*l;return 12742e3*Math.asin(Math.sqrt(a))}function V(e,t=Number.MAX_VALUE){let o=[];for(e.m_oPrev=e,e.m_dDist=0,o.push(e);o.length>0;){let e=o[o.length-1];o.splice(o.length-1,1);for(let n of e.m_oRefs.values()){let r=n.m_oGeo[0];r===e&&(r=n.m_oGeo[n.m_oGeo.length-1]);let s=e.m_dDist+n.m_dCost;if(s<r.m_dDist&&(r.m_dDist=s,r.m_oPrev=e,r.m_oEdgeToDest=n),!r.m_bProcessed&&r.m_dDist<t){let e=h(o,r,b.DIJKSTRACOMP);e<0&&o.splice(~e,0,r)}}e.m_bProcessed=!0}}var B=y(379),U=y.n(B),F=y(795),Y=y.n(F),H=y(569),j=y.n(H),k=y(565),q=y.n(k),W=y(216),K=y.n(W),J=y(589),Z=y.n(J),z=y(423),$={};$.styleTagTransform=Z(),$.setAttributes=q(),$.insert=j().bind(null,"head"),$.domAPI=Y(),$.insertStyleElement=K(),U()(z.Z,$),z.Z&&z.Z.locals&&z.Z.locals;var Q=function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function i(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,l)}a((n=n.apply(e,t||[])).next())}))};const{useState:ee}=e.React;let te=null;function oe(e){let t=[],o=[];for(let t of e.values())o.push([t.m_dX,t.m_dY]);t.push(o);let n=new r.default({paths:t,spatialReference:c.default.WGS84});te.layer.add(new l.default({geometry:n,attributes:{aaron:!0}})),requestAnimationFrame((()=>{}))}function ne(e,t){te.layer.add(new l.default({geometry:new o.default({x:e,y:t,spatialReference:c.default.WGS84}),attributes:{aaron:!0}})),requestAnimationFrame((()=>{}))}const re=o=>{var y;const[v,P]=ee(),[R,C]=ee(),[N,D]=ee(),[O,S]=ee(),[X,L]=ee(),[B,U]=ee(""),[F,Y]=ee(""),[H,j]=ee(""),[k,q]=ee("");let W=[],K=["cost_ft","ug_type","const_new"];function J(e){return Q(this,void 0,void 0,(function*(){q(e)}))}return e.React.createElement("div",{className:"widget-starter jimu-widget"},o.useMapWidgetIds&&1===o.useMapWidgetIds.length&&e.React.createElement(t.JimuMapViewComponent,{useMapWidgetId:null===(y=o.useMapWidgetIds)||void 0===y?void 0:y[0],onActiveViewChange:e=>{if(e){P(e);let o=new i.default({title:"Sketch Widget",id:"mySketch"});e.view.map.add(o),D(o);let n=new s.default({layer:o,view:e.view,creationMode:"single",snappingOptions:{enabled:!0,featureEnabled:!0},visible:!1});n.visibleElements={createTools:{circle:!1,polyline:!1,rectangle:!1},duplicateButton:!1,selectionTools:{"rectangle-selection":!1,"lasso-selection":!1},settingsMenu:!1},n.on("create",t),n.on("update",t),C(n),te=n,a.default.whenOnce((()=>!e.view.updating)).then((()=>Q(void 0,void 0,void 0,(function*(){let t='<option value="nothing_selected"></option>';for(let o of e.view.allLayerViews){if("World Hillshade"===o.layer.title||"World Topographic Map"===o.layer.title||"Sketch Widget"===o.layer.title)continue;t+=`<option value=${o.layer.id}>${o.layer.title}</option>`;const r=yield e.view.whenLayerView(e.view.map.findLayerById(o.layer.id));n.snappingOptions.featureSources.add(new p.default({layer:r.layer,enabled:!0}))}document.getElementById("select-address").innerHTML=t,document.getElementById("select-road").innerHTML=t,document.getElementById("select-output").innerHTML=t,document.getElementById("loading-widget-ui").remove(),document.getElementById("main-widget-ui").style.visibility="visible"}))))}function t(e){return Q(this,void 0,void 0,(function*(){"complete"===e.state&&("polygon"===e.tool?S(e.graphic.geometry):"point"===e.tool?L(e.graphic.geometry):"move"!==e.tool&&"transform"!==e.tool&&"reshape"!==e.tool||("point"===e.graphics[0].geometry.type?L(e.graphics[0].geometry):"polygon"===e.graphics[0].geometry.type&&S(e.graphics[0].geometry)))}))}}}),e.React.createElement("div",{id:"pageoverlay"},e.React.createElement("p",{id:"pageoverlay-content"},k)),e.React.createElement("div",{id:"loading-widget-ui"},"Loading widget... ",e.React.createElement("div",{className:"spinner"})),e.React.createElement("div",{style:"padding: 5px;",id:"main-widget-ui",style:{visibility:"hidden"}},e.React.createElement("label",null,"Select Address Layer",e.React.createElement("br",null),e.React.createElement("select",{id:"select-address",value:B,onChange:e=>U(e.target.value)})),e.React.createElement("label",null,"Select Road Layer",e.React.createElement("br",null),e.React.createElement("select",{id:"select-road",value:F,onChange:e=>Y(e.target.value)})),e.React.createElement("br",null),e.React.createElement("label",null,"Select Output Layer",e.React.createElement("br",null),e.React.createElement("select",{id:"select-output",value:H,onChange:e=>j(e.target.value)})),e.React.createElement("br",null),e.React.createElement("button",{onClick:function(){if(null!=X){let e=null;for(let t of R.layer.graphics)"point"===t.geometry.type&&(e=t);null!==e&&R.layer.remove(e),L(null)}R.create("point")}},"Draw Point")," ",e.React.createElement("button",{onClick:function(){if(null!=O){let e=null;for(let t of R.layer.graphics)"polygon"===t.geometry.type&&(e=t);null!==e&&R.layer.remove(e),S(null)}R.create("polygon")}},"Draw Area"),e.React.createElement("br",null),e.React.createElement("br",null),e.React.createElement("button",{onClick:function(){return Q(this,void 0,void 0,(function*(){const e=yield v.view.whenLayerView(v.view.map.findLayerById(H));let t=new f.default({url:e.layer.url});yield a.default.whenOnce((()=>!e.updating));let o={deleteFeatures:(yield t.queryFeatures()).features};t.applyEdits(o);let n=[];for(let e of R.layer.graphics)null!==e.attributes&&e.attributes.aaron&&n.push(e);R.layer.removeMany(n)}))}},"Clear Output")," ",e.React.createElement("button",{onClick:function(){return Q(this,void 0,void 0,(function*(){yield v.view.goTo([O,X]),document.getElementById("pageoverlay").style.visibility="visible";try{if(null==X||null==O)throw new Error("Must draw a point and area to execute");let e=_.default.load(),t=new m.default;t.spatialRelationship="intersects",t.geometry=O,t.returnGeometry=!0,J("query client points");const o=yield v.view.whenLayerView(v.view.map.findLayerById(B));let s=yield o.queryFeatures(new m.default({spatialRelationship:"intersects",geometry:O,returnGeometry:!0})),i=[],p=[];i.push(p);let y=new f.default({url:o.layer.url}),P=new u.default({url:o.layer.url});yield P.load();let R=5*P.capabilities.query.maxRecordCount;for(let e of s.features.values())p.push(e.getObjectId()),p.length===R&&(p=[],i.push(p));y.outFields=W,yield a.default.whenOnce((()=>!o.updating));let C=[];for(let e of i.values())0!==e.length&&C.push(y.queryFeatures(new m.default({outFields:W,objectIds:e,returnGeometry:!0,maxRecordCountFactor:5})));J(`query point server ${C.length} times`);let N=[];for(let e of C.values())for(let t of(yield e).features.values())N.push(t);let D=X.x,S=X.y,L=X.x,U=X.y;for(let e of O.rings[0].values())e[0]<D&&(D=e[0]),e[1]<S&&(S=e[1]),e[0]>L&&(L=e[0]),e[1]>U&&(U=e[1]);let Y=d.default.buffer(new n.default({rings:[[[D,S],[D,U],[L,U],[L,S],[D,S]]],spatialReference:O.spatialReference}),2,"kilometers");J("query client lines");const j=yield v.view.whenLayerView(v.view.map.findLayerById(F));let k=yield j.queryFeatures(new m.default({spatialRelationship:"intersects",geometry:Y}));i=[],p=[],i.push(p);let q=new f.default({url:j.layer.url}),Z=new u.default({url:j.layer.url});yield Z.load();let z=5*Z.capabilities.query.maxRecordCount;for(let e of k.features.values())p.push(e.getObjectId()),p.length===z&&(p=[],i.push(p));q.outFields=K,yield a.default.whenOnce((()=>!j.updating));let $=[];for(let e of i.values())0!==e.length&&$.push(q.queryFeatures(new m.default({outFields:K,objectIds:e,returnGeometry:!0,maxRecordCountFactor:5})));J(`query line server ${$.length} times`);let Q=[];for(let e of $.values()){let t=yield e;for(let e of t.features.values())d.default.disjoint(Y,e.geometry)||Q.push(e)}yield e;let ee=function(e,t,o,n,r,s,i){G.NULLEDGE.m_bKeep=!1;let l={},a=[],m=[],u=new b,d=[];i("projecting points");for(let t of e.values()){let e=n.project(t.geometry,s),o=new E;o.setCoords(e.longitude,e.latitude),d.push(o)}{let e=n.project(o,s),t=new E;t.setCoords(e.longitude,e.latitude),d.push(t)}i("projecting roads");for(let e of t.values()){let t=n.project(e.geometry,s);for(let o of t.paths.values()){let t=new G;t.m_dPricePerFt=e.attributes.cost_ft,t.m_sUgType=e.attributes.ug_type,t.m_sConstNew=e.attributes.const_new;for(let e of o.values())I(e[0],e[1],t,u,a,l);m.push(t)}}i("split"),m=function(e){let t=[],o=e.length;for(let n=0;n<o;n++){let o=e[n],r=!1,s=new G;s.m_oGeo.push(o.m_oGeo[0]);let i=o.m_oGeo.length-1;for(let e=1;e<i;e++){let n=o.m_oGeo[e];if(s.m_oGeo.push(n),1!==n.m_oRefs.length){s.m_dPricePerFt=o.m_dPricePerFt,s.m_sConstNew=o.m_sConstNew,s.m_sUgType=o.m_sUgType,t.push(s);for(let e=0;e<s.m_oGeo.length;e++){let t=s.m_oGeo[e];t.addRef(s),t.removeRef(o)}r=!0,s=new G,s.m_oGeo.push(n)}}if(r){s.m_oGeo.push(o.m_oGeo[o.m_oGeo.length-1]),s.m_dPricePerFt=o.m_dPricePerFt,s.m_sConstNew=o.m_sConstNew,s.m_sUgType=o.m_sUgType,t.push(s);for(let e=0;e<s.m_oGeo.length;e++){let t=s.m_oGeo[e];t.addRef(s),t.removeRef(o)}}else t.push(o)}return t}(m),i("merge"),m=function(e){let t=[],o=e.length;for(let t=0;t<o;t++){let o=e[t];if(!o.m_bKeep)continue;let n=o.m_oGeo[0],r=o.m_oGeo[o.m_oGeo.length-1],s=-1,i=-1;if(2==n.m_oRefs.length){let e=n.m_oRefs[0];if(o===e&&(e=n.m_oRefs[1]),e.m_dPricePerFt===o.m_dPricePerFt&&e.m_sConstNew===o.m_sConstNew&&e.m_sUgType===o.m_sUgType){let t=e.m_oGeo[0],r=e.m_oGeo[e.m_oGeo.length-1];0==w.SAMEPOINTCMP(n,t)?s=0:0==w.SAMEPOINTCMP(n,r)&&(s=1),s>=0&&A(o,e,s)}}if(2===r.m_oRefs.length){let e=r.m_oRefs[0];if(o===e&&(e=r.m_oRefs[1]),e.m_dPricePerFt===o.m_dPricePerFt&&e.m_sConstNew===o.m_sConstNew&&e.m_sUgType===o.m_sUgType){let t=e.m_oGeo[0],n=e.m_oGeo[e.m_oGeo.length-1];0==w.SAMEPOINTCMP(r,t)?i=2:0==w.SAMEPOINTCMP(r,n)&&(i=3),i>=0&&A(o,e,i)}}}for(let o of e.values())o.m_bKeep&&t.push(o);return t}(m),i("setting intersections");let c=[null,null];for(let e of m.values()){e.m_bKeep=!0,e.getHashes(),c[0]=e.m_oGeo[0],c[1]=e.m_oGeo[e.m_oGeo.length-1];for(let e of c.values())e.m_bIntersection=!0;for(let t of e.m_oCurrentHashes.values()){l.hasOwnProperty(t)||(l[t]=new M);let o=l[t];e.m_oHashIndices[t]=o.m_oEdges.length,o.m_oEdges.push(e)}}i("service points"),m=function(e,t,o,n,r){let s=1936.0000000000002/T,i=[Number.NaN,Number.NaN];for(let n of e.values())x(t,o,n,1760,s,i,r);let l=[];for(let e of Object.values(t))for(let t of e.m_oEdges.values())t.m_bKeep&&(t.m_nPos=l.length,l.push(t),t.m_bKeep=!1);return l}(d,l,a,0,u),i("distances");for(let e of m.values())e.calcDist(),e.m_dDist*=3.280839895,e.m_dCost=e.m_dDist*e.m_dPricePerFt;let _=d[d.length-1];return d.splice(d.length-1,1),{edges:m,hashes:l,nodes:a,routeTo:_,servicePoints:d}}(N,Q,X,_.default,d.default,c.default.WGS84,J);if(null===ee)return;J("Initial Routing"),V(ee.routeTo.m_oGraphPoint);for(let e of ee.nodes.values())e.m_oVToCO=e.m_oPrev,e.m_oEdgeToCO=e.m_oEdgeToDest,e.m_dDistToCO=e.m_dDist;let te=[],oe=[];for(let e of ee.servicePoints.values())null!==e.m_oGraphPoint&&(te.push(e),oe.push(e));te.sort(E.GRAPHDISTCOMP),oe.sort(E.REVERSEGRAPHDISTCOMP);let ne=ee.routeTo.m_oGraphPoint;for(ne.m_dTempDist=0,J("Optimizing routes");oe.length>0;){let e=oe[oe.length-1];oe.splice(oe.length-1,1);let t,o=e.m_oGraphPoint,n=[],r=[],s=[];for(;o!==ne;){if(null===o.m_oEdgeToCO||!(t=h(n,o.m_oEdgeToCO.m_nPos,g)<0)){r=[];break}if(n.splice(~t,0,o.m_oEdgeToCO.m_nPos),r.push(o.m_oEdgeToCO),o.m_dTempDist=o.m_dDistToCO,o.m_oTempV=o.m_oVToCO,o.m_oTempEdge=o.m_oEdgeToCO,s.push(o),o=o.m_oVToCO,null===o){r=[];break}}if(s.push(ne),0===r.length){oe.sort(E.REVERSEGRAPHDISTTOCOCOMP);continue}for(let e of ee.nodes.values())e.reset();let i=.5*e.m_oGraphPoint.m_dDistToCO;V(e.m_oGraphPoint,i),ee.nodes.sort(b.DISTCOMP),oe.sort(E.REVERSEGRAPHDISTCOMP);for(let t of ee.nodes.values()){if(t.m_dDist>i)break;if(t.m_dRouteDistance===Number.MAX_VALUE)continue;let n=[],l=[],a=t.m_dRouteDistance,m=t,u=t.m_oEdgeToDest;if(o=t.m_oPrev,t!=e.m_oGraphPoint){for(;o!==e.m_oGraphPoint;)n.push(u),l.push(m),a+=u.m_dDist,o.m_dTempDist=a,o.m_oTempV=m,o.m_oTempEdge=u,u=o.m_oEdgeToDest,m=o,o=o.m_oPrev;0===n.length&&(o.m_dTempDist=a,o.m_oTempV=m,o.m_oTempEdge=u),e.m_oGraphPoint.dTempDist=a+u.m_dDist,n.push(u),l.push(m),l.push(e.m_oGraphPoint),e.m_oGraphPoint.m_oTempV=m,e.m_oGraphPoint.m_oTempEdge=u}r=n,s=l;break}for(let e of s.values())e.m_dRouteDistance===Number.MAX_VALUE&&(e.m_dRouteDistance=e.m_dTempDist,e.m_oVForRoute=e.m_oTempV,e.m_oEdgeForRoute=e.m_oTempEdge);for(o=e.m_oGraphPoint;o!==ne;)++o.m_oEdgeForRoute.m_nAddressCount,o=o.m_oVForRoute;if(oe.length>0){let e=oe[oe.length-1];e.m_oGraphPoint.m_dDist>.5*e.m_oGraphPoint.m_dDistToCO&&oe.sort(E.REVERSEGRAPHDISTTOCOCOMP)}}let re=[];J("Updating output layer");for(let e of ee.edges.values()){if(0==e.m_nAddressCount)continue;let t=[],o=[];for(let t of e.m_oGeo.values())o.push([t.m_dX,t.m_dY]);t.push(o);let n=new r.default({paths:t,spatialReference:c.default.WGS84});re.push(new l.default({geometry:n,attributes:{cost_ft:e.m_dPricePerFt,const_new:e.m_sConstNew,ug_type:e.m_sUgType,cost_total:e.m_dCost,len_ft:e.m_dDist}}))}const se=yield v.view.whenLayerView(v.view.map.findLayerById(H));let ie=new f.default({url:se.layer.url});yield ie.applyEdits({addFeatures:re}),yield a.default.whenOnce((()=>!se.updating)),J("done"),setTimeout((()=>document.getElementById("pageoverlay").style.visibility="hidden"),1500)}catch(e){J(e),setTimeout((()=>document.getElementById("pageoverlay").style.visibility="hidden"),5e3)}}))}},"Execute")))};function se(e){y.p=e}})(),v})())}}}));